
skip_docs
default_platform(:ios)

platform :ios do

  desc "Runs the test target, which executes all the unit tests for each module
  within the SDK"
  lane :tests do
    sh("
      set -o pipefail && xcodebuild \
      -workspace '../PayPal.xcworkspace' \
      -sdk 'iphonesimulator' \
      -configuration 'Debug' \
      -scheme 'UnitTests' \
      -destination 'name=iPhone 12,platform=iOS Simulator' \
      test | xcpretty
      ")

    # run_tests(
    #   workspace: "PayPal.xcworkspace",
    #   device: "iPhone 12",
    #   scheme: "UnitTests",
    #   skip_build: true,
    #   output_types: "",
    #   code_coverage: true
    # )
  end

  lane :coverage do
    tests
    slather(
      scheme: "PayPal",
      proj: "PayPal.xcodeproj",
      workspace: "PayPal.xcworkspace",
      configuration: "Debug"
    )
    slather(
      scheme: "Card",
      proj: "PayPal.xcodeproj",
      workspace: "PayPal.xcworkspace",
      configuration: "Debug"
    )
    slather(
      scheme: "PaymentsCore",
      proj: "PayPal.xcodeproj",
      workspace: "PayPal.xcworkspace",
      configuration: "Debug"
    )
  end
end
